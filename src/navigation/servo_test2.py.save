import wiringpi2 as wiringpi
import time

# main() function                                                               
def main():
  print("starting PWM")

  # use BCM GPIO numbers                                                        
  wiringpi.wiringPiSetupGpio()

  # enable PWM0                                                                 
  wiringpi.pinMode(13,2)
  wiringpi.pwmSetMode(0)
  wiringpi.pwmSetClock(400)
  wiringpi.pwmSetRange(1024)
  wiringpi.pwmWrite(13, 0)

  # enable PWM1                                                                 
  wiringpi.pinMode(12,2)
  wiringpi.pwmSetMode(0)
  wiringpi.pwmSetClock(400)
  wiringpi.pwmSetRange(1024)
  wiringpi.pwmWrite(13, 0)
  
  # loop                                                                        
  dtMin, dtMax = 2, 128
  dt = 2
  while True:
    try:
      print(dt)
      wiringpi.pwmWrite(18, dt)
      wiringpi.pwmWrite(13, dtMax-dt)
      dt = dt + 10
      if dt > dtMax:
        dt = dtMin
      time.sleep(0.5)
    except:
      # clean up                                                                
      wiringpi.pwmWrite(18, 0)
      wiringpi.pwmWrite(13, 0)
      print("exiting.")
      break
